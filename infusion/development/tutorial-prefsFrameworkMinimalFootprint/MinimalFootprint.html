<!DOCTYPE html>
<html lang="en">
    <head>
        <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <title>Preferences Framework: Minimal Footprint | Fluid Infusion</title>

        <link rel="stylesheet" href="../lib/foundation/normalize.css">
        <link rel="stylesheet" href="../lib/foundation/foundation.css">
        <link rel="stylesheet" href="../css/highlightjs-custom.css">
        <link rel="stylesheet" href="../lib/octicons/octicons.css">

        <link rel="stylesheet" type="text/css" href="../lib/infusion/src/framework/preferences/css/Enactors.css" />
        <link rel="stylesheet" type="text/css" href="../lib/infusion/src/framework/preferences/css/PrefsEditor.css" />
        <link rel="stylesheet" type="text/css" href="../lib/infusion/src/framework/preferences/css/SeparatedPanelPrefsEditor.css" />
        <link rel="stylesheet" href="../css/infusion-docs.css">

        <link rel="icon" type="image/png" href="../images/favico.png">

        <script type="text/javascript" src="../lib/infusion/dist/infusion-all.js"></script>
        <script type="text/javascript" src="../js/infusion-docs.js"></script>

        <script type="text/javascript" src="../lib/gpii-express/querystring-coding.js"></script>
        <script type="text/javascript" src="../lib/gpii-binder/transforms.js"></script>
        <script type="text/javascript" src="../lib/gpii-binder/binder.js"></script>

        
            <script type="text/javascript" src="../js/mini-search.js"></script>
        
    </head>
    <body class="infusion-docs fl-theme-prefsEditor-default">
        <div class="container infusion-docs-container">

            <!-- Skip Link -->
            <div id="skip">
                <a href="#tableOfContents">Jump to Table of Contents</a>
                <a href="#content">Skip to Content</a>
            </div>
            <!-- END skip link -->

            <!-- BEGIN markup for Preference Editor -->
            <div class="flc-prefsEditor-separatedPanel fl-prefsEditor-separatedPanel">
                <!-- This is the div that will contain the Preference Editor component -->
                <div class="flc-slidingPanel-panel flc-prefsEditor-iframe"></div>

                <!-- This div is for the sliding panel that shows and hides the Preference Editor controls -->
                <div class="fl-panelBar">
                    <span class="fl-prefsEditor-buttons">
                        <button id="reset" class="flc-prefsEditor-reset fl-prefsEditor-reset"><span class="fl-icon-undo"></span> Reset</button>
                        <button id="show-hide" class="flc-slidingPanel-toggleButton fl-prefsEditor-showHide">+ Show Display Preferences</button>
                    </span>
                </div>
            </div>

            <script type="text/javascript">
                fluid.uiOptions.prefsEditor(".flc-prefsEditor-separatedPanel", {
                    terms: {
                        "templatePrefix": "../lib/infusion/src/framework/preferences/html",
                        "messagePrefix": "../lib/infusion/src/framework/preferences/messages"
                    },
                    "tocTemplate": "../lib/infusion/TableOfContents.html"
                });
            </script>

            <!-- END markup for Preference Editor -->

            <header class="row infusion-docs-header">
                <div class="infusion-docs-fluidLogo small-12 medium-3 column">
                    <a class="infusion-docs-fluidLogoText" href="../index.html" title="Infusion">infusion</a>
                </div>

                <nav class="infusion-docs-fluidCategories small-12 medium-9 column">
                    
                    
                        
                            <a href="../index.html" title="Infusion">Infusion</a>
                        
                    
                        
                            <a href="../index-tutorials.html" title="Tutorials" class="infusion-docs-category-active">Tutorials</a>
                        
                    
                        
                            <a href="../index-components.html" title="Components">Components</a>
                        
                    
                        
                            <a href="../search.html" title="Search">Search</a>
                        
                    
                </nav>
            </header>

            <div class="infusion-docs-mainBody">
                <nav id="tableOfContents" class="infusion-docs-TOC small-12 medium-3 column" tabindex="-1">
                    
                        <span class="infusion-docs-category">Search</span>
                        <p class="docs-search-mini"><input type="text" name="qs"/></p>

                        
                        
                            
                        
                        
                            
                                <span class="infusion-docs-category">Tutorials</span>
                                
                                    <span class="infusion-docs-sectionName">Developer Introduction to the Infusion Framework</span>
                                    <ul>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-developerIntroduction/DeveloperIntroductionToInfusionFramework-OpeningRemarks.html"><span class="infusion-docs-TOC-pageName">Opening Remarks</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-developerIntroduction/DeveloperIntroductionToInfusionFramework-Components.html"><span class="infusion-docs-TOC-pageName">Components</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-developerIntroduction/DeveloperIntroductionToInfusionFramework-Invokers.html"><span class="infusion-docs-TOC-pageName">Invokers</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-developerIntroduction/DeveloperIntroductionToInfusionFramework-EventsAndInversionOfControl.html"><span class="infusion-docs-TOC-pageName">Events and Inversion of Control</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-developerIntroduction/DeveloperIntroductionToInfusionFramework-ModelsAndModelComponents.html"><span class="infusion-docs-TOC-pageName">Models and Model Components</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-developerIntroduction/DeveloperIntroductionToInfusionFramework-ViewsAndViewComponents.html"><span class="infusion-docs-TOC-pageName">Views and View Components</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-developerIntroduction/DeveloperIntroductionToInfusionFramework-SubcomponentsAndModelRelaying.html"><span class="infusion-docs-TOC-pageName">Subcomponents and Model Relaying</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-developerIntroduction/DeveloperIntroductionToInfusionFramework-RestructuringComponents.html"><span class="infusion-docs-TOC-pageName">Restructuring Components</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-developerIntroduction/DeveloperIntroductionToInfusionFramework-OverridingInvokersAndRefactoring.html"><span class="infusion-docs-TOC-pageName">Overriding Invokers and Refactoring</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-developerIntroduction/DeveloperIntroductionToInfusionFramework-ExtendingDesignsWithExistingComponents.html"><span class="infusion-docs-TOC-pageName">Extending Designs with Existing Components</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-developerIntroduction/DeveloperIntroductionToInfusionFramework-TransformingModelRelays.html"><span class="infusion-docs-TOC-pageName">Transforming Model Relays</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-developerIntroduction/DeveloperIntroductionToInfusionFramework-ConcludingRemarks.html"><span class="infusion-docs-TOC-pageName">Concluding Remarks</span></a>
                                                
                                            </li>
                                        
                                    </ul>
                                
                                    <span class="infusion-docs-sectionName">Getting Started with Infusion Component Design</span>
                                    <ul>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-gettingStartedWithInfusion/GettingStartedWithInfusion.html"><span class="infusion-docs-TOC-pageName">Getting Started with Infusion Component Design</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-gettingStartedWithInfusion/SetUpYourEnvironment.html"><span class="infusion-docs-TOC-pageName">Set up your environment</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-gettingStartedWithInfusion/DefineANamespaceAndCreateAClosure.html"><span class="infusion-docs-TOC-pageName">Define a namespace and create a closure</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-gettingStartedWithInfusion/PickAComponentType.html"><span class="infusion-docs-TOC-pageName">Pick a component type</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-gettingStartedWithInfusion/BasicComponentCreation-Components.html"><span class="infusion-docs-TOC-pageName">Basic Component Creation</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-gettingStartedWithInfusion/ModelComponents.html"><span class="infusion-docs-TOC-pageName">Model Components</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-gettingStartedWithInfusion/ViewComponents.html"><span class="infusion-docs-TOC-pageName">View Components</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-gettingStartedWithInfusion/RendererComponents.html"><span class="infusion-docs-TOC-pageName">Renderer Components</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-gettingStartedWithInfusion/Subcomponents.html"><span class="infusion-docs-TOC-pageName">Subcomponents</span></a>
                                                
                                            </li>
                                        
                                    </ul>
                                
                                    <span class="infusion-docs-sectionName">General</span>
                                    <ul>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-usingStringTemplates/UsingStringTemplates.html"><span class="infusion-docs-TOC-pageName">Using String Templates</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-iconFonts/HowToCreateAndUseFontIcons.html"><span class="infusion-docs-TOC-pageName">How to Create and Use Font Icons</span></a>
                                                
                                            </li>
                                        
                                    </ul>
                                
                                    <span class="infusion-docs-sectionName">Preferences Framework</span>
                                    <ul>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-prefsFramework/CreatingAPrefsEditor.html"><span class="infusion-docs-TOC-pageName">Creating a Preference Editor</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-prefsFramework/CreatingEnactors.html"><span class="infusion-docs-TOC-pageName">Creating Enactors</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-prefsFramework/InstantiatingTheEnhancerAndSettingsStoreOnly.html"><span class="infusion-docs-TOC-pageName">Instantiating the Enhancer and Settings Store Only</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-prefsFramework/StylingThePreferencesEditor.html"><span class="infusion-docs-TOC-pageName">Styling the Preferences Editor</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../to-do/AddingPrefsEditorToSite.html"><span class="infusion-docs-TOC-pageName">Adding a Basic Preferences Editor to a Site</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../to-do/WorkingWithPrefsEditorOnSite.html"><span class="infusion-docs-TOC-pageName">Working With A Preferences Editor On Your Site</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-prefsFramework/CreatingANewAdjusterUI.html"><span class="infusion-docs-TOC-pageName">Creating a New Adjuster UI</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <span class="infusion-docs-TOC-pageName">Minimal Footprint</span>
                                                
                                            </li>
                                        
                                    </ul>
                                
                                    <span class="infusion-docs-sectionName">User Interface Options</span>
                                    <ul>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-userInterfaceOptions/UserInterfaceOptions.html"><span class="infusion-docs-TOC-pageName">Setting Up User Interface Options</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-userInterfaceOptions/WorkingWithUserInterfaceOptions.html"><span class="infusion-docs-TOC-pageName">Working with User Interface Options</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-userInterfaceOptions/UsingImagesInContrastModes.html"><span class="infusion-docs-TOC-pageName">Using Images in Contrast Modes</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-userInterfaceOptions/StyleEffectsAndLegibilityInContrastModes.html"><span class="infusion-docs-TOC-pageName">Style Effects and Legibility in Contrast Modes</span></a>
                                                
                                            </li>
                                        
                                            <li>
                                                
                                                    <a href="../tutorial-userInterfaceOptions/ContentPropertyHighContrast.html"><span class="infusion-docs-TOC-pageName">CSS &#x27;Content&#x27; Property in Contrast Modes</span></a>
                                                
                                            </li>
                                        
                                    </ul>
                                
                            
                        
                        
                            
                        
                        
                            
                        
                    
                </nav>

                <article id="content" class="infusion-docs-mainContent small-12 medium-9 column" tabindex="-1">
                    <div class="infusion-docs-articleContainer">

                        <div class="flc-toc-tocContainer infusion-docs-toc"> </div>

                        <h1>Preferences Framework: Minimal Footprint</h1>

                        <p class="infusion-docs-githubLink"><a href="https://github.com/fluid-project/infusion-docs/blob/master/src/documents/tutorial-prefsFrameworkMinimalFootprint/MinimalFootprint.md" target="_blank">Edit on GitHub</a></p>

                        

                        <div class="infusion-docs-articleBody">
                            
                                <p>Website performance optimization can be split into several categories: backend, over the wire, and front end. When
constructing your optimization strategy, you should examine the effect that each category has on your site's
performance. This document will focus on optimizing &quot;over the wire&quot; and &quot;front end&quot; performance when employing the
<a href="../PreferencesFramework.html">Preferences Framework</a> on a site; however, it does not examine potential backend
optimizations.</p>
<p>Below are some resources which discuss general website optimization strategies:</p>
<ul>
<li><a href="https://developers.google.com/speed/">https://developers.google.com/speed/</a></li>
<li><a href="https://developers.google.com/speed/docs/insights/rules">https://developers.google.com/speed/docs/insights/rules</a></li>
<li><a href="https://developers.google.com/web/fundamentals/performance">https://developers.google.com/web/fundamentals/performance</a></li>
<li><a href="https://www.maxcdn.com/blog/frontend-optimizations/">https://www.maxcdn.com/blog/frontend-optimizations/</a></li>
<li><a href="https://www.smashingmagazine.com/2014/09/improving-smashing-magazine-performance-case-study/">https://www.smashingmagazine.com/2014/09/improving-smashing-magazine-performance-case-study/</a></li>
<li><a href="https://hpbn.co">https://hpbn.co</a></li>
</ul>
<h2 id="optimization-of-the-preferences-framework">Optimization of the Preferences Framework</h2>
<ul>
<li>Use a minified <a href="https://github.com/fluid-project/infusion#how-do-i-create-an-infusion-package">custom build of Infusion</a></li>
<li>Use the grade version of a full page <a href="../PreferencesEditor.html">Preferences Editor</a></li>
<li><a href="https://en.wikipedia.org/wiki/Lazy_loading">Lazy load</a></li>
</ul>
<p>To see a live version of the example outlined below, open the <a href="http://build.fluidproject.org/infusion/examples/framework/preferences/minimalFootprint/">Minimal Footprint - Preferences
Framework</a> example.</p>
<div class="infusion-docs-note">
    <strong>Note:</strong> The example outlined below uses individual JS files. However, these can be substituted by
    using an Infusion build.
</div>
<h3 id="minified-custom-build">Minified Custom Build</h3>
<p>Infusion provides a build tool for creating minified custom packages. This is essential for creating the smallest
package which requires the fewest requests. From the Infusion root directory run <code>grunt custom --include=&quot;preferences&quot;</code>,
which will create a zip file containing all of the bundled code.</p>
<p>See: &quot;<a href="https://github.com/fluid-project/infusion/blob/master/README.md#how-do-i-create-an-infusion-package">How Do I Create an Infusion
Package</a>&quot;
documentation for the full list of steps.</p>
<h3 id="full-page-preferences-editor">Full Page Preferences Editor</h3>
<p>Most website integrations of a <a href="../PreferencesEditor.html">Preferences Editor</a> make use of <a href="../tutorial-userInterfaceOptions/UserInterfaceOptions.html">UI
Options</a>. UI Options provides a convenient interaction for
users to quickly review and modify their preferences without having to leave the page, and presents a live preview of
their adjustments. However, this also adds additional overhead to instantiate the preferences editor and load in all of
the required resources. A Full Page preference editor, on the other hand, is designed to run as a stand alone page and
can be configured with a preview window. Be sure to provide the user with a link to the full page preferences editor,
for example a link on each content page or in the site's user settings.</p>
<div class="infusion-docs-note">
    <strong>Note:</strong> Preferences Editors can be configured either through an <a
    href="../AuxiliarySchemaForPreferencesFramework.html">Auxiliary Schema</a> or directly through grades. The grade
    version is slightly more complicated to configure, but removes computation time for processing the schema.
</div>
<h4 id="instantiating-a-full-page-preferences-editor">Instantiating a Full Page Preferences Editor</h4>
<p>The following example instantiates a Full Page Preferences Editor with a preview window.
The code consists of the following three parts:</p>
<ol>
<li><code>fluid.prefs.globalSettingsStore</code> - Responsible for storing/retrieving preferences. By default it uses the
<code>fluid.prefs.cookieStore</code> which uses a browser cookie for storage.</li>
<li><code>fluid.pageEnhancer</code> - Initializes the UI Enhancer for the page. The UI Enhancer is responsible for applying the
preferences to the page.</li>
<li><code>fluid.prefs.fullPreview</code> - The Full Page prefs editor, including a preview.</li>
</ol>
<p>(see: <a href="https://github.com/fluid-project/infusion/blob/master/examples/framework/preferences/minimalFootprint/fullPage.html">fullPage.html</a>)</p>
<div class="infusion-docs-note">
    <strong>Note:</strong> The code snippet below can be loaded in through a JavaScript file or added directly to the
    HTML in a <code>&lt;script&gt;</code> tag.
</div>
<pre class="highlight"><code class="hljs javascript">    <span class="hljs-comment">/*
    /*
     * The various starter gradeNames mentioned below indicate that the
     * "starter" adjusters and enactors should be used. These correspond to the
     * same set of adjusters and enactors used in a typical UI Options
     * configuration. However, a custom set of adjusters and enactors could be
     * configured instead.
     */</span>

    <span class="hljs-comment">/**
     * Initialize the PrefsEditor global settings store.
     * The globalSettingsStore handles the storage and retrieval of preferences,
     * by default it is configured to use the fluid.prefs.cookieStore
     * which stores preferences in a browser cookie.
     */</span>
    fluid.prefs.globalSettingsStore();

    <span class="hljs-comment">/**
     * Initialize the UI Enhancer for the page.
     */</span>
    fluid.pageEnhancer({
        <span class="hljs-attr">uiEnhancer</span>: {
            <span class="hljs-attr">gradeNames</span>: [<span class="hljs-string">"fluid.uiEnhancer.starterEnactors"</span>],
            <span class="hljs-comment">// The UI Enhancer's Table of Contents uses an HTML template. This tells the component</span>
            <span class="hljs-comment">// where to find that template.</span>
            <span class="hljs-attr">tocTemplate</span>: <span class="hljs-string">"../../../../src/components/tableOfContents/html/TableOfContents.html"</span>
        }
    });

    fluid.prefs.fullPreview(<span class="hljs-string">".demo-prefsEditor-fullWithPreview"</span>, {
        <span class="hljs-attr">gradeNames</span>: [<span class="hljs-string">"fluid.prefs.transformDefaultPanelsOptions"</span>, <span class="hljs-string">"fluid.prefs.initialModel.starter"</span>],
        <span class="hljs-comment">// Tell PrefsEditor where to find all the resources, relative to this file</span>
        <span class="hljs-attr">terms</span>: {
            <span class="hljs-comment">// The Preferences Editor interface is defined by several HTML templates. The component</span>
            <span class="hljs-comment">// needs to know where those templates are.</span>
            <span class="hljs-attr">templatePrefix</span>: <span class="hljs-string">"../../../../src/framework/preferences/html"</span>,
            <span class="hljs-comment">//  The strings used on Preferences Editor interface are defined in several JSON files. The component</span>
            <span class="hljs-comment">//  needs to know where those files are.</span>
            <span class="hljs-attr">messagePrefix</span>: <span class="hljs-string">"../../../../src/framework/preferences/messages"</span>
        },
        <span class="hljs-attr">messageLoader</span>: {
            <span class="hljs-attr">gradeNames</span>: [<span class="hljs-string">"fluid.prefs.starterMessageLoader"</span>]
        },
        <span class="hljs-attr">templateLoader</span>: {
            <span class="hljs-attr">gradeNames</span>: [<span class="hljs-string">"fluid.prefs.starterFullPreviewTemplateLoader"</span>]
        },
        <span class="hljs-attr">prefsEditor</span>: {
            <span class="hljs-attr">gradeNames</span>: [<span class="hljs-string">"fluid.prefs.starterPanels"</span>, <span class="hljs-string">"fluid.prefs.uiEnhancerRelay"</span>],
            <span class="hljs-attr">listeners</span>: {
                <span class="hljs-comment">// Tells the PrefsEditor where to redirect to if the user cancels the operation.</span>
                <span class="hljs-comment">// In this case, it goes back one step in the browser's history.</span>
                <span class="hljs-attr">onCancel</span>: {
                    <span class="hljs-string">"this"</span>: <span class="hljs-built_in">window</span>.history,
                    <span class="hljs-attr">method</span>: <span class="hljs-string">"back"</span>
                }
            }
        },
        <span class="hljs-attr">preview</span>: {
            <span class="hljs-attr">templateUrl</span>: <span class="hljs-string">"html/prefsEditorPreview.html"</span>
        }
    });
</code></pre>
<h3 id="lazy-loading">Lazy Loading</h3>
<p>With a Full Page Preferences Editor we've moved editing preferences off the content pages; however, these pages are
still required to enact/apply the preferences set by the user. Therefore, we still need to instantiate the <a href="../SettingsStore.html">Settings
Store</a> and <a href="../Enactors.html">Page Enhancer</a> on each page. However, we only need these if a user has
actually adjusted their preferences. In a default implementation of the Preferences Framework, preferences are stored in
a browser cookie. The simple solution is to check for the presence of this cookie, and only load and instantiate the
Settings Store and Page Enhancer if it's found.</p>
<p>The following example makes use the functions provided by
<a href="https://github.com/fluid-project/infusion/blob/master/examples/framework/preferences/minimalFootprint/js/loadScripts.js">loadScripts.js</a>
to check the cookie and lazy load the required scripts:</p>
<p>The first step is to check if a cookie for user preferences was set. If it is found, the necessary JavaScript files
should be loaded. By lazy loading the scripts we save on the download and processing time for the scripts when they are
not in use.</p>
<p>(see:
<a href="https://github.com/fluid-project/infusion/blob/master/examples/framework/preferences/minimalFootprint/js/loadScripts.js">loadScripts.js</a>)</p>
<div class="infusion-docs-note">
<p><strong>Note:</strong> The example below makes use of a build of Infusion, &quot;infusion-custom.js&quot;, which is a
concatenated JavaScript file. However, the linked code above uses the individual JavaScript files. Using the single
&quot;infusion-custom.js&quot; file will save on server requests and is the preferred method, but will require a <a href="#minified-custom-build">custom
build</a> to be generated.</p>
</div>
<pre class="highlight"><code class="hljs xml"><span class="hljs-comment">&lt;!-- Add the following script tag to the HTML of each page --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="actionscript">
    <span class="hljs-comment">// "fluid-ui-settings" is the default cookie name</span>
    fluid_load.lazyLoadScripts(<span class="hljs-string">"fluid-ui-settings"</span>, [
        <span class="hljs-comment">// need to load the custom build of infusion first</span>
        <span class="hljs-string">"../infusion/infusion-custom.js"</span>,
        <span class="hljs-comment">// should point at a JavaScript file containing the instantiation of the</span>
        <span class="hljs-comment">// settings store and page enhancer. You'll need to write this yourself,</span>
        <span class="hljs-comment">// but an example has been provided below.</span>
        <span class="hljs-string">"js/lazyLoad.js"</span>
    ]);
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>The following is an example of an instantiation script.
(see: <a href="https://github.com/fluid-project/infusion/blob/master/examples/framework/preferences/minimalFootprint/js/lazyLoad.js">lazyLoad.js</a>)</p>
<pre class="highlight"><code class="hljs javascript"><span class="hljs-comment">/**
 * Initialize the PrefsEditor global settings store.
 * The globalSettingsStore handles the storage and retrieval of preferences,
 * by default it is configured to use the fluid.prefs.cookieStore
 * which stores preferences in a browser cookie.
 */</span>
fluid.prefs.globalSettingsStore();

<span class="hljs-comment">/**
 * Initialize the UI Enhancer for the page.
 */</span>
fluid.pageEnhancer({
    <span class="hljs-attr">uiEnhancer</span>: {
        <span class="hljs-comment">//  The "fluid.uiEnhancer.starterEnactors" grade mentioned below indicate that the</span>
        <span class="hljs-comment">//  "starter" enactors should be used. These correspond to the</span>
        <span class="hljs-comment">//  same set of enactors used in a typical UI Options configuration. However, a</span>
        <span class="hljs-comment">//  custom set of enactors could be configured instead.</span>
        <span class="hljs-attr">gradeNames</span>: [<span class="hljs-string">"fluid.uiEnhancer.starterEnactors"</span>],
        <span class="hljs-comment">// The UI Enhancer's Table of Contents uses an HTML template. This tells the component</span>
        <span class="hljs-comment">// where to find that template.</span>
        <span class="hljs-attr">tocTemplate</span>: <span class="hljs-string">"../../../../src/components/tableOfContents/html/TableOfContents.html"</span>
    }
});
</code></pre>
<h2 id="caveats">Caveats</h2>
<p>While the strategy outlined above will improve page load performance, it is not without its drawbacks.</p>
<ul>
<li>Prefs Editor
<ul>
<li>Users will have to navigate away from the current content to adjust settings</li>
<li>The preview of changes is not a live preview of the content</li>
</ul>
</li>
<li>Lazy Loading
<ul>
<li>For users that have set preferences, page load will be slightly slower because of the lazy loading overhead</li>
<li>For users that have set preferences, there is a higher chance that the user will see the adjustments applied to the
page (e.g. screen flicker, page layout shifting, and etc.)</li>
</ul>
</li>
</ul>

                            
                        </div>
                    </div>

                    <footer class="row infusion-docs-footer">
                        <p class="infusion-docs-footerInfusion">Infusion is created by the <a href="http://fluidproject.org/" target="_blank">Fluid Project</a>,<br/>
                        a project of the <a href="http://idrc.ocad.ca/" target="_blank">Inclusive Design Research Centre</a> at <a href="http://www.ocadu.ca/" target="_blank">OCAD University</a>, funded by a grant from <a href="http://www.mellon.org/" target="_blank">The Andrew W. Mellon Foundation</a>.</p>
                    </footer>

                </article>

            </div>


        </div> <!-- end container -->
        <script>
            fluid.docs.onLoad();
            
                fluid.docs.search.mini(".docs-search-mini")
            
    </script>

    </body>

</html>
